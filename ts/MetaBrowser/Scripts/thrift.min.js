var Thrift={Version:"1.0.0-dev",Type:{STOP:0,VOID:1,BOOL:2,BYTE:3,I08:3,DOUBLE:4,I16:6,I32:8,I64:10,STRING:11,UTF7:11,STRUCT:12,MAP:13,SET:14,LIST:15,UTF8:16,UTF16:17},MessageType:{CALL:1,REPLY:2,EXCEPTION:3,ONEWAY:4},objectLength:function(n){var t=0;for(var i in n)n.hasOwnProperty(i)&&t++;return t},inherits:function(n,t,i){function r(){}r.prototype=t.prototype;n.prototype=new r;n.prototype.name=i||""}};Thrift.TException=function(n){this.message=n};Thrift.inherits(Thrift.TException,Error,"TException");Thrift.TException.prototype.getMessage=function(){return this.message};Thrift.TApplicationExceptionType={UNKNOWN:0,UNKNOWN_METHOD:1,INVALID_MESSAGE_TYPE:2,WRONG_METHOD_NAME:3,BAD_SEQUENCE_ID:4,MISSING_RESULT:5,INTERNAL_ERROR:6,PROTOCOL_ERROR:7,INVALID_TRANSFORM:8,INVALID_PROTOCOL:9,UNSUPPORTED_CLIENT_TYPE:10};Thrift.TApplicationException=function(n,t){this.message=n;this.code=typeof t=="number"?t:0};Thrift.inherits(Thrift.TApplicationException,Thrift.TException,"TApplicationException");Thrift.TApplicationException.prototype.read=function(n){for(var t,i;;){if(t=n.readFieldBegin(),t.ftype==Thrift.Type.STOP)break;i=t.fid;switch(i){case 1:t.ftype==Thrift.Type.STRING?(t=n.readString(),this.message=t.value):t=n.skip(t.ftype);break;case 2:t.ftype==Thrift.Type.I32?(t=n.readI32(),this.code=t.value):t=n.skip(t.ftype);break;default:t=n.skip(t.ftype)}n.readFieldEnd()}n.readStructEnd()};Thrift.TApplicationException.prototype.write=function(n){n.writeStructBegin("TApplicationException");this.message&&(n.writeFieldBegin("message",Thrift.Type.STRING,1),n.writeString(this.getMessage()),n.writeFieldEnd());this.code&&(n.writeFieldBegin("type",Thrift.Type.I32,2),n.writeI32(this.code),n.writeFieldEnd());n.writeFieldStop();n.writeStructEnd()};Thrift.TApplicationException.prototype.getCode=function(){return this.code};Thrift.Transport=Thrift.TXHRTransport=function(n,t){this.url=n;this.wpos=0;this.rpos=0;this.useCORS=t&&t.useCORS;this.send_buf="";this.recv_buf=""};Thrift.TXHRTransport.prototype={getXmlHttpRequestObject:function(){try{return new XMLHttpRequest}catch(n){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(i){}throw"Your browser doesn't support XHR.";},flush:function(n,t){var r=this,i;if(n&&!t||this.url===undefined||this.url==="")return this.send_buf;if(i=this.getXmlHttpRequestObject(),i.overrideMimeType&&i.overrideMimeType("application/json"),t&&(i.onreadystatechange=function(){var n=t;return function(){this.readyState==4&&this.status==200&&(r.setRecvBuffer(this.responseText),n())}}()),i.open("POST",this.url,!!n),i.send(this.send_buf),!n||!t){if(i.readyState!=4)throw"encountered an unknown ajax ready state: "+i.readyState;if(i.status!=200)throw"encountered a unknown request status: "+i.status;this.recv_buf=i.responseText;this.recv_buf_sz=this.recv_buf.length;this.wpos=this.recv_buf.length;this.rpos=0}},jqRequest:function(n,t,i,r){if(typeof jQuery=="undefined"||typeof jQuery.Deferred=="undefined")throw"Thrift.js requires jQuery 1.5+ to use asynchronous requests";var u=this;return jQuery.ajax({url:this.url,data:t,type:"POST",cache:!1,contentType:"application/json",dataType:"text thrift",converters:{"text thrift":function(t){u.setRecvBuffer(t);return r.call(n)}},context:n,success:jQuery.makeArray(i).pop()})},setRecvBuffer:function(n){this.recv_buf=n;this.recv_buf_sz=this.recv_buf.length;this.wpos=this.recv_buf.length;this.rpos=0},isOpen:function(){return!0},open:function(){},close:function(){},read:function(n){var i=this.wpos-this.rpos,t,r;return i===0?"":(t=n,i<n&&(t=i),r=this.read_buf.substr(this.rpos,t),this.rpos+=t,r)},readAll:function(){return this.recv_buf},write:function(n){this.send_buf=n},getSendBuffer:function(){return this.send_buf}};Thrift.TWebSocketTransport=function(n){this.__reset(n)};Thrift.TWebSocketTransport.prototype={__reset:function(n){this.url=n;this.socket=null;this.callbacks=[];this.send_pending=[];this.send_buf="";this.recv_buf="";this.rb_wpos=0;this.rb_rpos=0},flush:function(n,t){var i=this;this.isOpen()?(this.socket.send(this.send_buf),this.callbacks.push(function(){var n=t;return function(t){i.setRecvBuffer(t);n()}}())):this.send_pending.push({buf:this.send_buf,cb:t})},__onOpen:function(){var n=this;this.send_pending.length>0&&(this.send_pending.forEach(function(t){this.socket.send(t.buf);this.callbacks.push(function(){var i=t.cb;return function(t){n.setRecvBuffer(t);i()}}())}),this.send_pending=[])},__onClose:function(){this.__reset(this.url)},__onMessage:function(n){this.callbacks.length&&this.callbacks.shift()(n.data)},__onError:function(n){console.log("Thrift WebSocket Error: "+n.toString());this.socket.close()},setRecvBuffer:function(n){this.recv_buf=n;this.recv_buf_sz=this.recv_buf.length;this.wpos=this.recv_buf.length;this.rpos=0},isOpen:function(){return this.socket&&this.socket.readyState==this.socket.OPEN},open:function(){this.socket&&this.socket.readyState!=this.socket.CLOSED||(this.socket=new WebSocket(this.url),this.socket.onopen=this.__onOpen.bind(this),this.socket.onmessage=this.__onMessage.bind(this),this.socket.onerror=this.__onError.bind(this),this.socket.onclose=this.__onClose.bind(this))},close:function(){this.socket.close()},read:function(n){var i=this.wpos-this.rpos,t,r;return i===0?"":(t=n,i<n&&(t=i),r=this.read_buf.substr(this.rpos,t),this.rpos+=t,r)},readAll:function(){return this.recv_buf},write:function(n){this.send_buf=n},getSendBuffer:function(){return this.send_buf}};Thrift.TJSONProtocol=Thrift.Protocol=function(n){this.tstack=[];this.tpos=[];this.transport=n};Thrift.Protocol.Type={};Thrift.Protocol.Type[Thrift.Type.BOOL]='"tf"';Thrift.Protocol.Type[Thrift.Type.BYTE]='"i8"';Thrift.Protocol.Type[Thrift.Type.I16]='"i16"';Thrift.Protocol.Type[Thrift.Type.I32]='"i32"';Thrift.Protocol.Type[Thrift.Type.I64]='"i64"';Thrift.Protocol.Type[Thrift.Type.DOUBLE]='"dbl"';Thrift.Protocol.Type[Thrift.Type.STRUCT]='"rec"';Thrift.Protocol.Type[Thrift.Type.STRING]='"str"';Thrift.Protocol.Type[Thrift.Type.MAP]='"map"';Thrift.Protocol.Type[Thrift.Type.LIST]='"lst"';Thrift.Protocol.Type[Thrift.Type.SET]='"set"';Thrift.Protocol.RType={};Thrift.Protocol.RType.tf=Thrift.Type.BOOL;Thrift.Protocol.RType.i8=Thrift.Type.BYTE;Thrift.Protocol.RType.i16=Thrift.Type.I16;Thrift.Protocol.RType.i32=Thrift.Type.I32;Thrift.Protocol.RType.i64=Thrift.Type.I64;Thrift.Protocol.RType.dbl=Thrift.Type.DOUBLE;Thrift.Protocol.RType.rec=Thrift.Type.STRUCT;Thrift.Protocol.RType.str=Thrift.Type.STRING;Thrift.Protocol.RType.map=Thrift.Type.MAP;Thrift.Protocol.RType.lst=Thrift.Type.LIST;Thrift.Protocol.RType.set=Thrift.Type.SET;Thrift.Protocol.Version=1;Thrift.Protocol.prototype={getTransport:function(){return this.transport},writeMessageBegin:function(n,t,i){this.tstack=[];this.tpos=[];this.tstack.push([Thrift.Protocol.Version,'"'+n+'"',t,i])},writeMessageEnd:function(){var n=this.tstack.pop();this.wobj=this.tstack.pop();this.wobj.push(n);this.wbuf="["+this.wobj.join(",")+"]";this.transport.write(this.wbuf)},writeStructBegin:function(){this.tpos.push(this.tstack.length);this.tstack.push({})},writeStructEnd:function(){var t=this.tpos.pop(),i=this.tstack[t],n="{",r=!0;for(var u in i)r?r=!1:n+=",",n+=u+":"+i[u];n+="}";this.tstack[t]=n},writeFieldBegin:function(n,t,i){this.tpos.push(this.tstack.length);this.tstack.push({fieldId:'"'+i+'"',fieldType:Thrift.Protocol.Type[t]})},writeFieldEnd:function(){var t=this.tstack.pop(),n=this.tstack.pop();this.tstack[this.tstack.length-1][n.fieldId]="{"+n.fieldType+":"+t+"}";this.tpos.pop()},writeFieldStop:function(){},writeMapBegin:function(n,t){this.tpos.push(this.tstack.length);this.tstack.push([Thrift.Protocol.Type[n],Thrift.Protocol.Type[t],0])},writeMapEnd:function(){var n=this.tpos.pop(),u,t,r,f,i;if(n!=this.tstack.length){for((this.tstack.length-n-1)%2!=0&&this.tstack.push(""),u=(this.tstack.length-n-1)/2,this.tstack[n][this.tstack[n].length-1]=u,t="}",r=!0;this.tstack.length>n+1;)f=this.tstack.pop(),i=this.tstack.pop(),r?r=!1:t=","+t,isNaN(i)||(i='"'+i+'"'),t=i+":"+f+t;t="{"+t;this.tstack[n].push(t);this.tstack[n]="["+this.tstack[n].join(",")+"]"}},writeListBegin:function(n,t){this.tpos.push(this.tstack.length);this.tstack.push([Thrift.Protocol.Type[n],t])},writeListEnd:function(){for(var n=this.tpos.pop(),t;this.tstack.length>n+1;)t=this.tstack[n+1],this.tstack.splice(n+1,1),this.tstack[n].push(t);this.tstack[n]="["+this.tstack[n].join(",")+"]"},writeSetBegin:function(n,t){this.tpos.push(this.tstack.length);this.tstack.push([Thrift.Protocol.Type[n],t])},writeSetEnd:function(){for(var n=this.tpos.pop(),t;this.tstack.length>n+1;)t=this.tstack[n+1],this.tstack.splice(n+1,1),this.tstack[n].push(t);this.tstack[n]="["+this.tstack[n].join(",")+"]"},writeBool:function(n){this.tstack.push(n?1:0)},writeByte:function(n){this.tstack.push(n)},writeI16:function(n){this.tstack.push(n)},writeI32:function(n){this.tstack.push(n)},writeI64:function(n){this.tstack.push(n)},writeDouble:function(n){this.tstack.push(n)},writeString:function(n){var r,i,t;if(n===null)this.tstack.push(null);else{for(r="",i=0;i<n.length;i++)t=n.charAt(i),r+=t==='"'?'\\"':t==="\\"?"\\\\":t==="\b"?"\\b":t==="\f"?"\\f":t==="\n"?"\\n":t==="\r"?"\\r":t==="\t"?"\\t":t;this.tstack.push('"'+r+'"')}},writeBinary:function(n){this.writeString(n)},readMessageBegin:function(){this.rstack=[];this.rpos=[];this.robj=typeof JSON!="undefined"&&typeof JSON.parse=="function"?JSON.parse(this.transport.readAll()):typeof jQuery!="undefined"?jQuery.parseJSON(this.transport.readAll()):eval(this.transport.readAll());var r={},version=this.robj.shift();if(version!=Thrift.Protocol.Version)throw"Wrong thrift protocol version: "+version;return r.fname=this.robj.shift(),r.mtype=this.robj.shift(),r.rseqid=this.robj.shift(),this.rstack.push(this.robj.shift()),r},readMessageEnd:function(){},readStructBegin:function(){var n={};return n.fname="",this.rstack[this.rstack.length-1]instanceof Array&&this.rstack.push(this.rstack[this.rstack.length-1].shift()),n},readStructEnd:function(){this.rstack[this.rstack.length-2]instanceof Array&&this.rstack.pop()},readFieldBegin:function(){var t={},n=-1,u=Thrift.Type.STOP,r,f,i;for(r in this.rstack[this.rstack.length-1])if(r!==null){n=parseInt(r,10);this.rpos.push(this.rstack.length);f=this.rstack[this.rstack.length-1][n];delete this.rstack[this.rstack.length-1][n];this.rstack.push(f);break}if(n!=-1)for(i in this.rstack[this.rstack.length-1])Thrift.Protocol.RType[i]!==null&&(u=Thrift.Protocol.RType[i],this.rstack[this.rstack.length-1]=this.rstack[this.rstack.length-1][i]);return t.fname="",t.ftype=u,t.fid=n,t},readFieldEnd:function(){for(var n=this.rpos.pop();this.rstack.length>n;)this.rstack.pop()},readMapBegin:function(){var n=this.rstack.pop(),i=n.shift(),t;return i instanceof Array&&(this.rstack.push(n),n=i,i=n.shift()),t={},t.ktype=Thrift.Protocol.RType[i],t.vtype=Thrift.Protocol.RType[n.shift()],t.size=n.shift(),this.rpos.push(this.rstack.length),this.rstack.push(n.shift()),t},readMapEnd:function(){this.readFieldEnd()},readListBegin:function(){var n=this.rstack[this.rstack.length-1],t={};return t.etype=Thrift.Protocol.RType[n.shift()],t.size=n.shift(),this.rpos.push(this.rstack.length),this.rstack.push(n),t},readListEnd:function(){this.readFieldEnd()},readSetBegin:function(n,t){return this.readListBegin(n,t)},readSetEnd:function(){return this.readListEnd()},readBool:function(){var n=this.readI32();return n.value=n!==null&&n.value=="1"?!0:!1,n},readByte:function(){return this.readI32()},readI16:function(){return this.readI32()},readI32:function(n){var t,i;if(n===undefined&&(n=this.rstack[this.rstack.length-1]),t={},n instanceof Array)t.value=n.length===0?undefined:n.shift();else if(n instanceof Object){for(i in n)if(i!==null){this.rstack.push(n[i]);delete n[i];t.value=i;break}}else t.value=n,this.rstack.pop();return t},readI64:function(){return this.readI32()},readDouble:function(){return this.readI32()},readString:function(){return this.readI32()},readBinary:function(){return this.readString()},skip:function(n){var t,i;switch(n){case Thrift.Type.STOP:return null;case Thrift.Type.BOOL:return this.readBool();case Thrift.Type.BYTE:return this.readByte();case Thrift.Type.I16:return this.readI16();case Thrift.Type.I32:return this.readI32();case Thrift.Type.I64:return this.readI64();case Thrift.Type.DOUBLE:return this.readDouble();case Thrift.Type.STRING:return this.readString();case Thrift.Type.STRUCT:for(this.readStructBegin();;){if(t=this.readFieldBegin(),t.ftype==Thrift.Type.STOP)break;this.skip(t.ftype);this.readFieldEnd()}return this.readStructEnd(),null;case Thrift.Type.MAP:for(t=this.readMapBegin(),i=0;i<t.size;i++)i>0&&this.rstack.length>this.rpos[this.rpos.length-1]+1&&this.rstack.pop(),this.skip(t.ktype),this.skip(t.vtype);return this.readMapEnd(),null;case Thrift.Type.SET:for(t=this.readSetBegin(),i=0;i<t.size;i++)this.skip(t.etype);return this.readSetEnd(),null;case Thrift.Type.LIST:for(t=this.readListBegin(),i=0;i<t.size;i++)this.skip(t.etype);return this.readListEnd(),null}}};Thrift.MultiplexProtocol=function(n,t,i,r){Thrift.Protocol.call(this,t,i,r);this.serviceName=n};Thrift.inherits(Thrift.MultiplexProtocol,Thrift.Protocol,"multiplexProtocol");Thrift.MultiplexProtocol.prototype.writeMessageBegin=function(n,t,i){t===Thrift.MessageType.CALL||t===Thrift.MessageType.ONEWAY?Thrift.Protocol.prototype.writeMessageBegin.call(this,this.serviceName+":"+n,t,i):Thrift.Protocol.prototype.writeMessageBegin.call(this,n,t,i)};Thrift.Multiplexer=function(){this.seqid=0};Thrift.Multiplexer.prototype.createClient=function(n,t,i){var r;return t.Client&&(t=t.Client),r=this,t.prototype.new_seqid=function(){return r.seqid+=1,r.seqid},new t(new Thrift.MultiplexProtocol(n,i))};
//# sourceMappingURL=thrift.min.js.map
